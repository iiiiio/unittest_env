dist: trusty
language: python
install:
- pip install -r requirements.txt
addons:
  firefox: latest
  sonarcloud:
    organization: iiiiio
    token:
      secure: pawso2YR4yr6ZibQoP5XViRj3wJ3G3+1+yybCiunlEwMJvbzIxSR5gtm1rHwj0ETfb45YbAwZChxYzy6JPFQvZlGfBdAMSakpciNe+UiW23qA/faJk92tF6rSU8npxDiPRglLVfPShSOuMSrYHR93N22kupDNbAAG8ycKECJSCAWfgy06w3FCaU4+1IAB0VKnldbp+wktXKnCN2XsloEgPFma923JHxDSv+tMCNvf+xd/d2n+xO5AT/mIx5VhLRORIOwYwjLzkQDRyOjUMKfJeda7LPbt4Gr4r0zHfh8x19JMozZTBI3Vu8BbcjkFSjywVnUgldHYd7LrU7I8UwwJwdZAf0nn3hldgM48FX80yBgjdAmVG0DvFqfp5jPDnJRaO9OtqIYhrflAjzXoI69x4BD2PkgIyqo8Y7/F+JS7LFmlGpwikMV4a4oCcZPOkMF29Apcd3fHC1af25yXKwxappXIcpvIegQ7WJMZyIOttQIuHP4oTTuWsBE6oEqjk0Q7B+k8pgBrQjwX2+X0kZ9C0ITaYa7ygLBizHYGL5ObVHr2E7NFPd/reXfKNs1N8fF9zEyVzhjLQVam2puZovy9bi/x9wR5yKbLi3lFxPZsMu3jbo6gqW0AsWnD429GNjwy549xKLWlypM9NO6Hwp6Mh877q3cEo17MeojHXbJhks=
before_install:
- wget https://github.com/mozilla/geckodriver/releases/download/v0.25.0/geckodriver-v0.25.0-linux64.tar.gz
- mkdir geckodriver
- tar -xzf geckodriver-v0.25.0-linux64.tar.gz -C geckodriver
- export PATH=$PATH:$PWD/geckodriver
- geckodriver --version
- export MOZ_HEADLESS=1
env:
  matrix:
  - MOZ_HEADLESS=1
  global:
  - secure: r/IoIBP/kHQwQ+FLITOPNcsXDDQM0/5jRqgaObr9CYs9PjsOr/XwMbuKnCwCN1L+0hVmUAsYP/6ToLByaMdv+uweHNI5GRmm+nV8eKwxBHZu67CBmOyhJRnKECMhMuzJe1HpmS9W/K+1G67TtK+HLGXfKdJ3KS31BzUdAv84VjVHmUdxwLRFnI3Kyk8PZ5hu2TG0bPOyrI0scUjc9n4aNPCIJUvAL0ykPUA50dGs83t9CWM/F0KNC5kt32XhFIlSt293HD38nzI7rWWKmmz8GviaamrYTawQi142YQ7uP7q04I/po5dhkVY2V8Wh72DLowxfteUy8e/oaXRMKIm6CnljqxsQFFKlkEndrvRKLWDa0PDP5+3SNzqOdlFpeIaywjPRRJPYIiMfFCb4g368BZpTsdAV3NKhjw9B7Kt/CSWE4BfdHpX+ylidltcu+fXPMB8E3ZnNLiQXpGwHHc9H/RVucgDSYXcX3YbkMUl+I67DpI1HqZESitPOlybOMRqdqa+woTMDvbdfuyeeklTKlshwLmlOI3YaCTeeh+yi1G88sQjhWCEqyEAd8Hgnv2EJ15zsWZwLPbt5OiTGmwb4PMowWixzSWOVryxzxnm2EqhtBKoJDppDTRPtuBi/4kvunedVjJuUHDIH4okwoJUIGBVD1N+C6hMijm5pzexvfi0=
jobs:
  include:
  - stage: test
    script: python manage.py test
  - stage: sonar-scanning
    script: sonar-scanner
  - stage: GitHub Release
    script: echo "Deploying to GitHub releases ..."
    deploy:
      provider: releases
      api_key:
        secure: nCtoxeKQvvkbDctAXxLMTegXfPvIlnAQ20RQl1WdjAT9RRfyEWvHrc7SfDiu17S9CWYao2ugfVvEdO9HvVW5ho7c1hw7Qra3BJEU/bakQ+njGPVyny5vVTLdXywmKE3Qq+4dd2+isZAu1M8EKbEw2o1jtcX/1U/Suc2bDdC4pwLw1/KjoswKCUbOqD55fPaZ/WRTvAaR4Cc0hf/Rjo2Wnn6Ll9reta6SpytuJzYhLSZduo//FvGGiOwV9Tjay2oddqTRYf6Ya/mtOkr4k69JAyPDZFaaXR+Yva4MnR73XJrIx20p3Gaol7EPJF41IfheXTsm/L6931kt0YfV/J6IhOtjrln/vKA3mewrGaJ/YWy7N94qJYwrdSYFV7lF9Wzu1mwUxx5bvuJa6DyVOK+bMtfRE+YzstTPye5F91wlKsW0UBAwSCBuM4VcUOMBcmlxz+Ja7DRup4mriOBRWBg2oUYdTWYZhXxm+yPYbdfVwplcGVw8vnejUDGFtGLoYCqMZdfTORmtESP/JTyN/A2pWXs5OjfMDrDa1jCzVOlSFUTK1tEeDK9Qs0aLFRSAiRBFKU13SvwnHZjozuO1jVCF+7KPDUKcVbNn5TESpGVrMnj3rwNIQha62ce8Rf9UcJNOaow+uHfKpCHjmj4A0H7Iqng+cqGgoZzxjXqyxSW5LxQ=
      skip_cleanup: true
      on:
        branch: staging
branches:
  only:
  - master
  - staging
