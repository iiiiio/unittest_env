dist: trusty
language: python
install:
- pip install -r requirements.txt
addons:
  firefox: latest
  sonarcloud:
    organization: iiiiio
    token:
      secure: "qQQ3tuYRgDMGUeEnaTX21LZBuF4RjCZgDHbh/83OMMB0dQP4YPVT0KeZonC4GhamV5PhQ8jDOSlBnwtFbY9yF9yvr+OabHcDGf/XvJiLkNQy1oZAuWX8G0BM6CDCWHtjlYBm1ooK8z8y/L+5NAC0EWOOAfNfnCTDDv8v1a+JxciNHbovFzZOQ1rCRL5xjwV3p9V8P1/uiQ+wD5+pu0B7Lwiqx1HKXtO5KYFLipcWoa6b345TitYa23ys1LcBUzqnoxC5+nBmtOvh2kF3/VUPRxtHuQZ3mGwcc9SxYcICrGawOv7fIZ1CrVU0F7GcoezhExST+7WlAPjAv8JqGOe57fgW8GOI5K1qH+L9rQ8QC0Z7/DN1mF7pCc9C5vTacHgsDShOAjRXYBoACjQG5jYwuc35LVl1kbTf8skv77UYrS7DAO7kVQdtKaXzt4L5e7UMCiM/XBhaPgKkdy++bq1/lowCdjgBnl/zf+j2zCcN1li34KS/9yC+sDBIv74Eox6WpBpbNwjHCJBsiF3loGXS0dUA0n9QtNTWcu45mmu+z6bRVdnYw28zcSKbYV2fAxkTyzpfJg0eHM7GJOL+rze8G2jTrS7OEsCcVzYlrhoGvJ6HGsU6xKtbrdd8yiwKAXAzXneoGD0Dg1brWwliMVfPuzJtZSj0gY+85sPD8CzwFkw="
before_install:
- wget https://github.com/mozilla/geckodriver/releases/download/v0.25.0/geckodriver-v0.25.0-linux64.tar.gz
- mkdir geckodriver
- tar -xzf geckodriver-v0.25.0-linux64.tar.gz -C geckodriver
- export PATH=$PATH:$PWD/geckodriver
- geckodriver --version
- export MOZ_HEADLESS=1
env:
- MOZ_HEADLESS=1
jobs:
  include:
  - stage: test
    script: python manage.py test
  - stage: sonar-scanning
    script: sonar-scanner
  - stage: GitHub Release
    script: echo "Deploying to GitHub releases ..."
    deploy:
      provider: releases
      api_key: vhTskLgB7YzGUY5/DMrCawV3DUW6NJeWpPQgS23bWR42NBeT5kccultnWJvuiKFB/J+5yyG+fmq4P36PuvJEK2uxSvo/Z5eRpDmqelOT5ySvi+/LKDpBok435sUBS59OuRitz40qb4Wv8/pD9zjZfYysNeF/0PLHDQWELdp+e4Z7ImHixHOTBDAj00+vi8dbK6+uHQeMFvYYw6vLa92M7mrrGWTsVSjJtlkuxIJVjnLI2MMSHZhKQCjeYeCRIttPw/bhePOYf2WTP1UFpGm68MchqoZuzIHUJq3SAtWIBlw8Vp5FhHeXp5dgVsx3yjBnlK3TnAODJ4KFF+9SFZ+3ylsf0d6x9A98owFPJHHHUo/rqu44b8VgAQ5nv8iBx/8Dr1/+bymXhN3F0FcEb/BRsSfVU/pSbzkTmYZ2RzNE1rjSQ6ReaAhZMlKE5l+7O6otU99YxIApngLcdIJk8xRR7V18iKcVmnabeVxj4L9+ArjQ9fopJkOpt22r2KPdu/LYntcpmyP7r3JX1h/3qfzEURgviqw9fA6aLy/OrEoKSVOthgs7gsdy3l9Xt+uu3IdET9rAtxeY+qzlg8ghAPPJRgd/3fANUjj6LjwUzFDjL4j/sivmRcAOCddeuGGyaWoEunP/YCPQfVsNKyaC5gSKE/BleRQ8LAVbe58VYBU8hhg=
      skip_cleanup: true
      on:
        branch: staging
branches:
  only:
  - master
  - staging
#deploy:
#  api_key:
#    secure: vhTskLgB7YzGUY5/DMrCawV3DUW6NJeWpPQgS23bWR42NBeT5kccultnWJvuiKFB/J+5yyG+fmq4P36PuvJEK2uxSvo/Z5eRpDmqelOT5ySvi+/LKDpBok435sUBS59OuRitz40qb4Wv8/pD9zjZfYysNeF/0PLHDQWELdp+e4Z7ImHixHOTBDAj00+vi8dbK6+uHQeMFvYYw6vLa92M7mrrGWTsVSjJtlkuxIJVjnLI2MMSHZhKQCjeYeCRIttPw/bhePOYf2WTP1UFpGm68MchqoZuzIHUJq3SAtWIBlw8Vp5FhHeXp5dgVsx3yjBnlK3TnAODJ4KFF+9SFZ+3ylsf0d6x9A98owFPJHHHUo/rqu44b8VgAQ5nv8iBx/8Dr1/+bymXhN3F0FcEb/BRsSfVU/pSbzkTmYZ2RzNE1rjSQ6ReaAhZMlKE5l+7O6otU99YxIApngLcdIJk8xRR7V18iKcVmnabeVxj4L9+ArjQ9fopJkOpt22r2KPdu/LYntcpmyP7r3JX1h/3qfzEURgviqw9fA6aLy/OrEoKSVOthgs7gsdy3l9Xt+uu3IdET9rAtxeY+qzlg8ghAPPJRgd/3fANUjj6LjwUzFDjL4j/sivmRcAOCddeuGGyaWoEunP/YCPQfVsNKyaC5gSKE/BleRQ8LAVbe58VYBU8hhg=
